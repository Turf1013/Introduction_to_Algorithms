\section{Offline Algorithm}
\label{sec:offline}
In this section, we propose an approximation algorithm for the LIA problem.
This method is based on minimum cost flow and we proof the approximation ratio of this method is $0.625\frac{r_{max}}{r_{min}}$.

The basic idea of this algorithm is to get a optimal arrangement before a certain number of workers appear.
Therefore, if the global optimal arrangement have enough reliability in this period, this method will get the same amount.
However, if the optimal arrangement can only get small amount reliability, then it might finish all the tasks more slowly.
Considering all these two cases, the approximation ratio is bounded by $0.625\frac{r_{max}}{r_{min}}$, which will be proved later.
Since the key point of this method is how to calculate this certain number, it is better to introduce Theorem~\ref{thm:boundOfLIA} before 
explaining the method.

\begin{theorem}[LIA* bound]
\label{thm:boundOfLIA}
Assume $|T| \ge K$ and $\delta \ge 2r_{max}$,
the lower bound of LIA problem is $\frac{|T|\delta}{Kr_{max}}$ and the upper bound is $\frac{|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1$.
\end{theorem}

\begin{proof}
According to the famous McNaughton's Rule\cite{NaughtonRule}, it is easy to make an optimal arrangement when every workers contributes the same reliability $r$ to every tasks.
In fact, the answer is $\max\{\lceil \frac{|T| \cdot \lceil \frac{\delta}{r} \rceil}{K} \rceil,\ \delta\}$ and the optimal arrangement can be solved in polynomial time.
Then it is easy to get both lower bound and upper bound by replacing $r$ with $r_{max}$ and $r_{min}$ respectively.
\begin{align*}
	bound_{lower} &\ge \max\{\lceil \frac{|T| \cdot \lceil \frac{\delta}{r_{max}} \rceil}{K} \rceil,\ \delta\} \\
					&\ge \max\{\lceil \frac{|T|\delta}{Kr_{max}} \rceil,\ \delta \} \\
					&\ge \frac{|T|\delta}{Kr_{max}}  \\
	bound_{upper} &\le \max\{\lceil \frac{|T| \cdot \lceil \frac{\delta}{r_{min}} \rceil}{K} \rceil,\ \delta\} \\
					&\le \max\{ \frac{|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1,\ \delta \} \\
					&\le \frac{|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1
\end{align*}
\end{proof}

According to McNaughton's Rule\cite{NaughtonRule}, it is obvious that the lower bound can be achieved only when each task is assigned to the worker with highest reliability.
Then, in order to get better approximation ratio, it is better to get as many high reliability as possible.
Therefore, we divide all the workers into different batches and transform the instance in each batch to the Minimum Cost Maximum Flow(MCMF) problem at the first.
Secondly, we keep all the arrangement from MCMF while some workers might still be able to peform tasks and we use greedy to allocate the tasks.
Finally, whenever all the tasks reach the threshold, we stop the procedure and return the arrangement.
At first, we explain the MCMF step in details.

Given an instance of LIA problem with only parts of the workers $W'$, we construct a flow network $G_F = (N_F, E_F)$ as follows.
$N_F = T \cup W' \cup \{st, ed\}$, where $st$ is a source node and $ed$ is a sink node. 
For every pair $w \in W', t \in T$, there is an edge $e_F(w, t) \in E_F$ from $w$ to $t$ with 
$e_F(w, t).cost = -\min\{\delta, \delta-S[t]\}$ and $e_F(w, t).capacity = 1$.
Here $S_{t}$ indicates the amount of reliability that $t$ has already got. 
For every $w \in W'$, there is an edge $e_F(st, w) \in E_F$ from $st$ to $w$ with
$e_F(st, w).cost = 0$ and $e_F(st, w).capacity = K$.
For every $t \in T$, there is an edge $e_F(t, ed) \in E_F$ from $t$ to $ed$ with 
$e_F(t, ed).cost = 0$ and $e_F(t, ed).capacity = \lceil \frac{t_{remain}}{U_{max}} \rceil$.
Therefore, after solving the MCMF, we have an temporary arrangement $M'$,
where each worker perform less than $K$ tasks and one task may be assigned to a bounded number of workers.
Particularly, we use the Successive Shortest Path Algorithm (SSPA) to calculate the
minimum cost flow since it is the one suitable for large-scale data and many-to-many matching with real-valued arc costs as pointed out by \cite{yiu2008capacity}.

Since the capacity of the edge $e_F(t, ed)$ is bounded by $\lceil \frac{t_{remain}}{U_{max}} \rceil$ tightly, 
sometimes it leads to a drawbacks that some workers can still perform more tasks.
So in the second step, tasks are greedily allocated to workers who only peform less than $K$ tasks according to $M'$.
Each time, the most reliable tasks that the worker has never performed before is assigned to him/her.
In this way, all the workers can perform as many tasks as they could and the tasks may get more reliability at each round.

\begin{algorithm}[t]
	\SetKwInOut{Input}{input}\SetKwInOut{Output}{output}
	\Input{$T, W, R(.,.), K, \delta, r_{max}$}
	\Output{A feasible arrangement $M$}
	$m \leftarrow \frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil, n \leftarrow |T|, S[1 \ldots n] \leftarrow \{0,0,\cdots,0\}$\;
	\For{$i \leftarrow 2$ \emph{\KwTo} $\lceil \frac{|W|}{m} \rceil$ and $n > 0$}{
		$W' \leftarrow $ another $\lfloor m \rfloor$($\lfloor 2m \rfloor$ when $i=2$) from workers\;
		construct $G_F = (N_F, E_F)$ according to $(W', T, S, r_{max})$\;
		MinCostFlow$(G_F)$ and construct $M'$ accordingly\;
		update the $S$ and $n$ according to $M'$\;
		\ForEach{$e_F(st, u) \in E_F$}{
			$Q \leftarrow \emptyset, k \leftarrow e_F(st, u).capacity - e_F(st, u).flow$\;
			\ForEach{$e_F(u, v) \in E_F$}{
				\If{$e_F(st, u).flow == 0$}{
					push $\{R(W[u], T[v]), v\}$ into $Q$\;
					\If{$|Q| > k$}{
						extract the least reliability pair from $Q$\;
					}
				}
				\While{$Q \neq \emptyset$}{
					extract a reliability pair $\{r, v\}$ from $Q$\;
					$M' \leftarrow M' \cup (u, v), S[i] \leftarrow S[i] + r$\;
					\If{$S[i] \ge \delta$} {
						$n \leftarrow n - 1$\;
					}
				}
			}
		}
		$M \leftarrow M \cup M'$\;
	}
	\If{$n > 0$}{
		\KwRet{$\emptyset$}
	}
	\Else{
		\KwRet{$M$}
	}
\caption{MCMF-LIA}
\label{alg:MCMF}
\end{algorithm}

The whole procedure is illustrated in Algorithm~\ref{alg:MCMF}. 
In lines 2-6, we first construct a flow network $G_F$ and calculate
the minimum cost flow on $G_F$ according to current workers and tasks as descrived before, 
and then obtain a temporary matching $M$. 
In the second step, we use greedy to assign more tasks to some of the workers and update $M'$ accordingly
in lines 7-18. Specifically, for each worker, we maintance the most reliable tasks by a heap $Q$ in lines 8-13.
Then in lines 14-18, the tasks get their corresponded increase of reliabilities and $n$ is reduced when some of them reach to threshold. 

\textbf{Approximation Ratio}. 
Next, we study the approximation ratio of MCMF-LIA.

\begin{lemma}
\label{lem:ratioNotFinish}
If optimal solution gets less than $|T|\delta$ from the first $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor$ workers,
then the competitive ratio is $\frac{1}{2}\frac{r_{max}}{r_{min}}$ in this situation.
\end{lemma}
\begin{proof}
According to the assumption, optimal solution needs at least another workers,
which is $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor + 1 \ge 2\frac{|T|\delta}{Kr_{max}}$ workers.
According to Theorem~\ref{thm:boundOfLIA}, any solution needs at most $\frac{|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1$ workers.
Thus, the ratio is 
\begin{equation*}
	\frac{\frac{|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1}{2\frac{|T|\delta}{Kr_{max}}} = \frac{1}{2}\frac{r_{max}}{r_{min}} + O(1)
\end{equation*}
\end{proof}

\begin{lemma}
\label{lem:functionOfMCMF}
Assume $\delta \ge 3r_{max}$,
if every task can be performed by $\lceil \frac{\delta}{r_{max}} \rceil$ different workers from the first $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor$ ones,
the Algorithm~\ref{alg:MCMF} will get at least $\frac{3}{4}$ of the optimal solution.
\end{lemma}
\begin{proof}
Since all the capacity between $t$ and $ed$ is no more than $\lceil \frac{\delta}{r_{max}} \rceil$,
then the absolute value of the result from MinCostFlow algorithm is equal to the optimal solution.
However, this does not mean Algorithm~\ref{alg:MCMF} will increase the same amount as the optimal solution.
Because, when $\delta \mod r_{max} = 1$, it might waste $r_{max}-1$ for each task.
Therefore, the real increasement of Algorithm~\ref{alg:MCMF} is at least 
$\frac{\lfloor \frac{\delta}{r_{max}} \rfloor}{\lceil \frac{\delta}{r_{max}} \rceil} \ge \frac{3}{4}$ of the absolute value of the minimum cost.
Thus, the Algorithm~\ref{alg:MCMF} will get at least $\frac{3}{4}$ increase of the optimal solution.
\end{proof}

\begin{lemma}
\label{lem:portionFinish}
If optimal solution gets more than $|T|\delta$ from the frist $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor$ workers,
then the Algorithm~\ref{alg:MCMF} will get at least $\frac{3}{8}|T|\delta$ from the same workers.
\end{lemma}
\begin{proof}
According to the assumption, every task should have been performed by no less than $\lceil \frac{\delta}{r_{max}} \rceil$ workers already,
otherwise it could not reach the threshold $\delta$.
At the same time, since there are $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor$ workers, 
all these workers can perform at most $2|T|\lceil \frac{\delta}{r_{max}} \rceil$ times in total.
Then the sum of largest $\frac{\delta}{r_{max}}$ increase of each task is at least $\frac{|T|\delta}{2}$.
According to Lemma~\ref{lem:functionOfMCMF}, Algorithm~\ref{alg:MCMF} must 
have got $\frac{3|T|\delta}{8}$ increase already.
\end{proof}

\begin{lemma}
\label{lem:ratioFinish}
If optimal solution gets less than $|T|\delta$ from the first $\lfloor 2\frac{|T|}{K}\lceil \frac{\delta}{r_{max}} \rceil \rfloor$ workers,
then the competitive ratio is $\frac{5}{8}\frac{r_{max}}{r_{min}}$ in this situation.
\end{lemma}
\begin{proof}
According to Lemma~\ref{lem:portionFinish}, the Algorithm~\ref{alg:MCMF} will get at least $\frac{3}{8}|T|\delta$ for now.
Then According to Theorem~\ref{thm:boundOfLIA}, it needs at most another $\frac{\frac{5}{8}|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1$ workers.
Thus, the ratio is
\begin{equation*}
	\frac{\frac{\frac{5}{8}|T|\delta}{Kr_{min}} + \frac{|T|}{K} + 1}{\frac{|T|\delta}{Kr_{max}}} = \frac{5}{8}\frac{r_{max}}{r_{min}} \\
\end{equation*}
\end{proof}

\begin{theorem}
The approximation ratio of Algorithm~\ref{alg:MCMF} is $0.625\frac{r_{max}}{r_{min}}$.
\end{theorem}
\begin{proof}
According to Lemma~\ref{lem:ratioNotFinish} and Lemma~\ref{lem:ratioFinish}, the ratio of Algorithm~\ref{alg:MCMF} is
\begin{equation*}
	\max\{\frac{1}{2},\ \frac{5}{8}\} {\frac{r_{max}}{r_{min}}} = 0.625\frac{r_{max}}{r_{min}}
\end{equation*}
\end{proof}

\textbf{Complexity Analysis}. 
The first step takes $O(\frac{\delta}{r_{max}} |T|^2\log{|T|})$ time and
the second step takes $O(\frac{\delta}{r_{max}} |T|^2\frac{\log{K}}{K})$ time.
Also the iteration takes $O(\frac{r_{max}|W|K}{\delta|T|})$ round at most.
Since $K$ is relatively small compared to $T$, the totay time cost is
$O(K|W||T|\log{|T|})$.